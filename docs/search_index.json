[["index.html", "Statistics and Machine Learning Notes Chapter 1 R notes 1.1 Tables", " Statistics and Machine Learning Notes Duzhe Wang (duzhe.stat@gmail.com) 2023-02-04 Chapter 1 R notes 1.1 Tables 1.1.1 How do we print lm results in Rmarkdown html/pdf? https://zief0002.github.io/book-8252/pretty-printing-tables-in-markdown.html https://cran.r-project.org/web/packages/broom/vignettes/broom.html https://stackoverflow.com/questions/55712224/in-bookdown-avoid-wide-tables-to-be-cut-off library(broom) library(tidyverse) library(kableExtra) lm(mpg ~ wt, mtcars) %&gt;% tidy() %&gt;% knitr::kable() term estimate std.error statistic p.value (Intercept) 37.285126 1.877627 19.857575 0 wt -5.344472 0.559101 -9.559044 0 lm(mpg ~ wt, mtcars) %&gt;% glance() %&gt;% knitr::kable() %&gt;% kable_styling() %&gt;% scroll_box(width = &quot;100%&quot;, box_css = &quot;border: 0px;&quot;) r.squared adj.r.squared sigma statistic p.value df logLik AIC BIC deviance df.residual nobs 0.7528328 0.7445939 3.045882 91.37533 0 1 -80.01471 166.0294 170.4266 278.3219 30 32 "],["subgroup-identification.html", "Chapter 2 Subgroup identification", " Chapter 2 Subgroup identification Subgroup analysis tools: https://biopharmnet.com/subgroup-analysis/ "],["individualized-treatment-rules.html", "Chapter 3 Individualized treatment rules 3.1 Books", " Chapter 3 Individualized treatment rules 3.1 Books Dynamic treatment regimes: statistical methods for precision medicine "],["interaction.html", "Chapter 4 Interaction 4.1 Example 1 4.2 Example 2", " Chapter 4 Interaction 4.1 Example 1 df=data.frame(y=c(3, 3, 3, 7, 8, 5, 6, 3, 5, 7), trt=as.factor(c(&quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;B&quot;, &quot;B&quot;, &quot;B&quot;, &quot;B&quot;, &quot;B&quot;)), center=as.factor(c(1, 1,1, 2, 2, 1, 1, 2,2, 2))) df ## y trt center ## 1 3 A 1 ## 2 3 A 1 ## 3 3 A 1 ## 4 7 A 2 ## 5 8 A 2 ## 6 5 B 1 ## 7 6 B 1 ## 8 3 B 2 ## 9 5 B 2 ## 10 7 B 2 The following three models are same. fit1=lm(y~trt*center, data=df) fit2=lm(y~trt+center+trt*center, data=df) fit3=lm(y~trt+center+trt:center, data=df) summary(fit1) ## ## Call: ## lm(formula = y ~ trt * center, data = df) ## ## Residuals: ## Min 1Q Median 3Q Max ## -2.000 -0.375 0.000 0.375 2.000 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 3.0000 0.7071 4.243 0.00542 ** ## trtB 2.5000 1.1180 2.236 0.06671 . ## center2 4.5000 1.1180 4.025 0.00692 ** ## trtB:center2 -5.0000 1.5811 -3.162 0.01951 * ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 1.225 on 6 degrees of freedom ## Multiple R-squared: 0.7353, Adjusted R-squared: 0.6029 ## F-statistic: 5.556 on 3 and 6 DF, p-value: 0.0363 summary(fit2) ## ## Call: ## lm(formula = y ~ trt + center + trt * center, data = df) ## ## Residuals: ## Min 1Q Median 3Q Max ## -2.000 -0.375 0.000 0.375 2.000 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 3.0000 0.7071 4.243 0.00542 ** ## trtB 2.5000 1.1180 2.236 0.06671 . ## center2 4.5000 1.1180 4.025 0.00692 ** ## trtB:center2 -5.0000 1.5811 -3.162 0.01951 * ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 1.225 on 6 degrees of freedom ## Multiple R-squared: 0.7353, Adjusted R-squared: 0.6029 ## F-statistic: 5.556 on 3 and 6 DF, p-value: 0.0363 summary(fit3) ## ## Call: ## lm(formula = y ~ trt + center + trt:center, data = df) ## ## Residuals: ## Min 1Q Median 3Q Max ## -2.000 -0.375 0.000 0.375 2.000 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 3.0000 0.7071 4.243 0.00542 ** ## trtB 2.5000 1.1180 2.236 0.06671 . ## center2 4.5000 1.1180 4.025 0.00692 ** ## trtB:center2 -5.0000 1.5811 -3.162 0.01951 * ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 1.225 on 6 degrees of freedom ## Multiple R-squared: 0.7353, Adjusted R-squared: 0.6029 ## F-statistic: 5.556 on 3 and 6 DF, p-value: 0.0363 model.matrix(fit1) ## (Intercept) trtB center2 trtB:center2 ## 1 1 0 0 0 ## 2 1 0 0 0 ## 3 1 0 0 0 ## 4 1 0 1 0 ## 5 1 0 1 0 ## 6 1 1 0 0 ## 7 1 1 0 0 ## 8 1 1 1 1 ## 9 1 1 1 1 ## 10 1 1 1 1 ## attr(,&quot;assign&quot;) ## [1] 0 1 2 3 ## attr(,&quot;contrasts&quot;) ## attr(,&quot;contrasts&quot;)$trt ## [1] &quot;contr.treatment&quot; ## ## attr(,&quot;contrasts&quot;)$center ## [1] &quot;contr.treatment&quot; model.matrix(fit2) ## (Intercept) trtB center2 trtB:center2 ## 1 1 0 0 0 ## 2 1 0 0 0 ## 3 1 0 0 0 ## 4 1 0 1 0 ## 5 1 0 1 0 ## 6 1 1 0 0 ## 7 1 1 0 0 ## 8 1 1 1 1 ## 9 1 1 1 1 ## 10 1 1 1 1 ## attr(,&quot;assign&quot;) ## [1] 0 1 2 3 ## attr(,&quot;contrasts&quot;) ## attr(,&quot;contrasts&quot;)$trt ## [1] &quot;contr.treatment&quot; ## ## attr(,&quot;contrasts&quot;)$center ## [1] &quot;contr.treatment&quot; model.matrix(fit3) ## (Intercept) trtB center2 trtB:center2 ## 1 1 0 0 0 ## 2 1 0 0 0 ## 3 1 0 0 0 ## 4 1 0 1 0 ## 5 1 0 1 0 ## 6 1 1 0 0 ## 7 1 1 0 0 ## 8 1 1 1 1 ## 9 1 1 1 1 ## 10 1 1 1 1 ## attr(,&quot;assign&quot;) ## [1] 0 1 2 3 ## attr(,&quot;contrasts&quot;) ## attr(,&quot;contrasts&quot;)$trt ## [1] &quot;contr.treatment&quot; ## ## attr(,&quot;contrasts&quot;)$center ## [1] &quot;contr.treatment&quot; Model: \\[y_i=\\beta_0+\\beta_1 I(i\\in \\text{trtB})+\\beta_2 I(i\\in \\text{center2})+\\beta_3 I(i \\in \\text{trtB and center2})+\\varepsilon_i \\] trtA &amp; center2: \\(\\beta_0+\\beta_2\\) trtB &amp; center2: \\(\\beta_0+\\beta_1+\\beta_2+\\beta_3\\) difference of trt effects conditioning on center2: \\(\\beta_1+\\beta_3\\) trtA &amp; center1: \\(\\beta_0\\) trtB &amp; center1: \\(\\beta_0+\\beta_1\\) difference of trt effects conditioning on center1: \\(\\beta_1\\) Therefore, there is an interaction between trt and center 4.2 Example 2 set.seed(12) f1 &lt;- gl(n = 2, k = 30, labels = c(&quot;Low&quot;, &quot;High&quot;)) ## generate factor levels f2 &lt;- as.factor(rep(c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;), times = 20)) modmat &lt;- model.matrix(~f1 * f2, data.frame(f1 = f1, f2 = f2)) ## make the design matrix coeff &lt;- c(1, 3, -2, -4, 1, -1.2) y &lt;- rnorm(n = 60, mean = modmat %*% coeff, sd = 0.1) dat &lt;- data.frame(y = y, f1 = f1, f2 = f2) summary(lm(y ~ f1 * f2)) ## ## Call: ## lm(formula = y ~ f1 * f2) ## ## Residuals: ## Min 1Q Median 3Q Max ## -0.199479 -0.063752 -0.001089 0.058162 0.222229 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 0.97849 0.02865 34.15 &lt;2e-16 *** ## f1High 3.00306 0.04052 74.11 &lt;2e-16 *** ## f2B -1.97878 0.04052 -48.83 &lt;2e-16 *** ## f2C -4.00206 0.04052 -98.77 &lt;2e-16 *** ## f1High:f2B 0.98924 0.05731 17.26 &lt;2e-16 *** ## f1High:f2C -1.16620 0.05731 -20.35 &lt;2e-16 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.09061 on 54 degrees of freedom ## Multiple R-squared: 0.9988, Adjusted R-squared: 0.9987 ## F-statistic: 8785 on 5 and 54 DF, p-value: &lt; 2.2e-16 model.matrix(lm(y ~ f1 * f2)) ## (Intercept) f1High f2B f2C f1High:f2B f1High:f2C ## 1 1 0 0 0 0 0 ## 2 1 0 1 0 0 0 ## 3 1 0 0 1 0 0 ## 4 1 0 0 0 0 0 ## 5 1 0 1 0 0 0 ## 6 1 0 0 1 0 0 ## 7 1 0 0 0 0 0 ## 8 1 0 1 0 0 0 ## 9 1 0 0 1 0 0 ## 10 1 0 0 0 0 0 ## 11 1 0 1 0 0 0 ## 12 1 0 0 1 0 0 ## 13 1 0 0 0 0 0 ## 14 1 0 1 0 0 0 ## 15 1 0 0 1 0 0 ## 16 1 0 0 0 0 0 ## 17 1 0 1 0 0 0 ## 18 1 0 0 1 0 0 ## 19 1 0 0 0 0 0 ## 20 1 0 1 0 0 0 ## 21 1 0 0 1 0 0 ## 22 1 0 0 0 0 0 ## 23 1 0 1 0 0 0 ## 24 1 0 0 1 0 0 ## 25 1 0 0 0 0 0 ## 26 1 0 1 0 0 0 ## 27 1 0 0 1 0 0 ## 28 1 0 0 0 0 0 ## 29 1 0 1 0 0 0 ## 30 1 0 0 1 0 0 ## 31 1 1 0 0 0 0 ## 32 1 1 1 0 1 0 ## 33 1 1 0 1 0 1 ## 34 1 1 0 0 0 0 ## 35 1 1 1 0 1 0 ## 36 1 1 0 1 0 1 ## 37 1 1 0 0 0 0 ## 38 1 1 1 0 1 0 ## 39 1 1 0 1 0 1 ## 40 1 1 0 0 0 0 ## 41 1 1 1 0 1 0 ## 42 1 1 0 1 0 1 ## 43 1 1 0 0 0 0 ## 44 1 1 1 0 1 0 ## 45 1 1 0 1 0 1 ## 46 1 1 0 0 0 0 ## 47 1 1 1 0 1 0 ## 48 1 1 0 1 0 1 ## 49 1 1 0 0 0 0 ## 50 1 1 1 0 1 0 ## 51 1 1 0 1 0 1 ## 52 1 1 0 0 0 0 ## 53 1 1 1 0 1 0 ## 54 1 1 0 1 0 1 ## 55 1 1 0 0 0 0 ## 56 1 1 1 0 1 0 ## 57 1 1 0 1 0 1 ## 58 1 1 0 0 0 0 ## 59 1 1 1 0 1 0 ## 60 1 1 0 1 0 1 ## attr(,&quot;assign&quot;) ## [1] 0 1 2 2 3 3 ## attr(,&quot;contrasts&quot;) ## attr(,&quot;contrasts&quot;)$f1 ## [1] &quot;contr.treatment&quot; ## ## attr(,&quot;contrasts&quot;)$f2 ## [1] &quot;contr.treatment&quot; Model: \\[y_i=\\beta_0+\\beta_1I(i\\in \\text{f1High})+\\beta_2I(i\\in \\text{f2B})+\\beta_3I(I\\in \\text{f2C})+ \\\\ \\beta_4 I(i\\in \\text{f1High and f2B})+\\beta_5 I(i\\in\\text{f1High and f2C})+\\varepsilon_i \\] f1 high and f2 A: \\(\\beta_0+\\beta_1\\) f1 high and f2 B: \\(\\beta_0+\\beta_1+\\beta_2+\\beta_4\\) f1 high and f2 C: \\(\\beta_0+\\beta_1+\\beta_3+\\beta_5\\) f1 low and f2 A: \\(\\beta_0\\) f1 low and f2 B: \\(\\beta_0+\\beta_2\\) f1 low and f2 C: \\(\\beta_0+\\beta_3\\) See more at https://rpubs.com/hughes/15353 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
